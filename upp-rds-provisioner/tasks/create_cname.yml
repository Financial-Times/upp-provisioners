---
# This task will create/update CNAME record

- include: cname_details.yml

- name: If it doesn't exist, create a new CNAME record
  uri:
    url: https://dns-api.in.ft.com/v2/
    method: POST
    HEADER_x-api-key: "{{ konstructor_api_key }}"
    body:
      zone: ft.com
      name: "{{ cluster_name }}.in"
      rdata: "{{ rds_hostname }}"
      ttl: "300"
      emailAddress: "universal.publishing.platform@ft.com"
    body_format: json
  register: dns_create_output

- name: DNS create output
  debug:
    msg: "{{ dns_create_output }}"